<script>
    
    var productSpecs = {{{DisplayJSON productDetails}}}

    $(function() {
        $("#gtc-cart-alert").hide();

        $("#gtc-add-to-cart").click(function () {
            $('#gtc-add-to-cart').prop('disabled', true);
            
            var cartInfo = {};
            cartInfo.product_quantity = $('#product-quantity').val();

            $.ajax({
                type: "POST",
                url: "/api/cart/add-cart/" + productSpecs.id,
                data: cartInfo,
                success: function (res) {
                    $('#gtc-add-to-cart').prop('disabled', false);
                    if(res && res.message === "SUCCESS"){
                        $('#gtc-cart-alert').removeClass('alert-danger').addClass('alert-success');
                        $('#gtc-cart-alert .cart-message').text(res.message_details)
                        $("#gtc-cart-alert").fadeTo(2000, 500).slideUp(500, function(){
                            $("#gtc-cart-alert").slideUp(500);
                        });  
                        console.log(res)
                    }
                },
                error: function (error) {
                    $('#gtc-add-to-cart').prop('disabled', false);
                    if(error){
                        $('#gtc-cart-alert').removeClass('alert-success').addClass('alert-danger');
                        $('#gtc-cart-alert .cart-message').text(error.responseJSON.message + " : " + error.responseJSON.message_details)
                        $("#gtc-cart-alert").fadeTo(3000, 500).slideUp(500, function(){
                            $("#gtc-cart-alert").slideUp(500);
                        });
                    }
                }
            });


        });

    });

</script>
{{> header/defaultHeader LoggedInUser = LoggedInUser}}
<div class="container" style="margin-top:40px;">

    <div class="alert" id="gtc-cart-alert">
        <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button>
        <span class="cart-message"></span>
    </div>

    <h3>
        <i>product view page</i>
    </h3>

    <div class="form-group float-right" style="display:flex">
        <input class="form-control" type="number" min="1" value="1" placeholder="quantity" id="product-quantity" style="width: 104px;margin-right: 15px;">
        <button id="gtc-add-to-cart" type="button" class="btn btn-danger btn-lg">Add to Cart</button>
    </div>

   

    <pre style="height:500px">
            Product Name: {{productDetails.product_name}}
            Product Price: {{productDetails.price}}
    </pre>

</div>
{{> footer/footer}}