<script>
	var discountLength = {{{ DisplayJSON editProduct.Discounts.length}}}

	var imageFiles = [], imageArr = [], attributeArr = [], discountArr = [], count, test;
	
	imageFiles = {{{DisplayJSON productImages}}}
	productBaseImage = {{{DisplayJSON productBaseImage}}}

	if(discountLength){
		var discountLength = {{editProduct.Discounts.length}}
		count = discountLength;
	}
	else{
		count =0;
	}

	function addProduct(productInput) {

		var obj = {};

		if(attributeArr.length > 0)
			obj.attributeArr = JSON.stringify(attributeArr);

		if(discountArr.length > 0 )
			obj.discountArr = JSON.stringify(discountArr);

		if(imageArr.length > 0 )
			obj.imageArr = JSON.stringify(imageArr);

		$.ajax({
			type: 'POST',
			url: '/api/product/add-product?' + productInput,
			data: obj,
			success: function(data) {
				$('#gtc-cart-alert').removeClass('alert-danger').addClass('alert-success');
				$('#gtc-cart-alert .cart-message').text("Product Added Successfully")
				$("#gtc-cart-alert").fadeTo(7000, 500).slideUp(500, function() {
					$("#gtc-cart-alert").slideUp(500);
				});
				$('.pip').empty();
				$('.base_image').empty();
				setTimeout(function() {
					location.reload(true);
				}, 1500);
			},
			error: function(error) {
				$('#gtc-cart-alert').removeClass('alert-success').addClass('alert-danger');
				$('#gtc-cart-alert .cart-message').text("Server Issue..Please try after sometime..")
				$("#gtc-cart-alert").fadeTo(7000, 500).slideUp(500, function() {
					$("#gtc-cart-alert").slideUp(500);
				});
				$('.pip').empty();
				$('.base_image').empty();
			}
		})		
	}

	function updateProduct(product_id,productInput){

		var obj = {};

		if(attributeArr.length > 0)
			obj.attributeArr = JSON.stringify(attributeArr);

		if(discountArr.length > 0 ){
			obj.discountArr = JSON.stringify(discountArr);
		}

		if(imageArr.length > 0 )
			obj.imageArr = JSON.stringify(imageArr);

		$.ajax({
			type: 'POST',
			url: '/api/product/edit-product?product_id=' + product_id+'&'+productInput,
			data: obj,
			success: function(data) {
				$('#gtc-cart-alert').removeClass('alert-danger').addClass('alert-success');
				$('#gtc-cart-alert .cart-message').text("Product Added Successfully")
				$("#gtc-cart-alert").fadeTo(7000, 500).slideUp(500, function() {
					$("#gtc-cart-alert").slideUp(500);
				});
				$('.pip').empty();
				$('.base_image').empty();
				setTimeout(function() {
					location.reload(true);
				}, 1500);
			},
			error: function(error) {
				$('#gtc-cart-alert').removeClass('alert-success').addClass('alert-danger');
				$('#gtc-cart-alert .cart-message').text("Server Issue..Please try after sometime..")
				$("#gtc-cart-alert").fadeTo(7000, 500).slideUp(500, function() {
					$("#gtc-cart-alert").slideUp(500);
				});
				$('.pip').empty();
				$('.base_image').empty();
			}
		})
	}

	function removeDiscount(e){
	
		$(e).parents(".discountRow").remove();
		count = count-1;

		if (count < 3) {
			$(".discount_tier").show();
		}
	}

	function removeImage(e, imageIndex) {

		imageFiles.splice(imageIndex, 1);
		$(e).parents(".pip").remove();

		appendImage();
	}

	function appendImage(){

		$(".preview" ).empty();

		for (var i = 0; i < imageFiles.length; i++) {
			var domElement;

			domElement = "<span class=\"pip\">" + "<img class=\"imageThumb\" src=\"" + imageFiles[i].uploadedImage + "\"/>" +
						"<i class='fa fa-times productRemoveIcon' onclick='removeImage(this,"+i+")' aria-hidden='true'></i></span>"

			$(".preview").append(domElement);
		}

		if (imageFiles.length >= 6) {
			$("#productImage").hide();
		}else{
			$("#productImage").show();
		}
	}

	function appendBaseImage(){

		for (var i = 0; i < productBaseImage.length; i++) {
			var temp = $($.parseHTML('<img style="width:200px; height:200px;">')).attr('src', 
			productBaseImage[i].uploadedBaseImage);
			$('div.base_image').html(temp);
		}		
	}

	function testValue(count) {
		$(".value_discount_amount" + count).show();
		$(".percent_discount_amount" + count).hide();
	}

	function testPercent(count) {
		$(".value_discount_amount" + count).hide();
		$(".percent_discount_amount" + count).show();
	}

	$(function(){
		$('#quantity_available').change(function(){

			if($('#quantity_available').val() == '0'){
				$('#product_status option').removeAttr('selected').filter('[value=SOLDOUT]').attr('selected', true);
				$("#product_status").prop("disabled", true);
			}else{
				$("#product_status").prop("disabled", false);
			}
     		  
  	 	 }).change()

	})

	$(document).ready(function() {

       	var cropBoxData, canvasData, cropper, cropperInputImage, cropperOutputImage;
		var fileDetails = {}, baseImageFileDetails;

		var product_id = $('#edit_product_id').val();

		$("#gtc-cart-alert").hide();

		$("#productImage").click(function(e) {
			$("#imageUpload").click();
		});

		$("#imageUpload").change(function() {
			test = '';
			fasterPreview(this);
		});

		$('#baseImage').on('change', function() {
			test = 'div.base_image';
			fasterPreview(this);
		});
		
		$('#crop-product-image').click(function() {

			if (test == 'div.base_image') {
				cropper.getCroppedCanvas().toBlob(function(blob) {

					fileDetails['cropperOutputImage'] = blob;
					fileDetails["croppedExtension"] = blob["type"].split("/")[1];
					fileDetails["fileName"] = fileDetails["originalFileName"] + "." + fileDetails["croppedExtension"];
					fileDetails['uploadedBaseImage'] = cropper.getCroppedCanvas().toDataURL();
					fileDetails['existing'] = 'no';

					productBaseImage.length = 0;
					productBaseImage.push(fileDetails);
					appendBaseImage();                  
				});

				$('#profile-picture-modal').modal('hide');

			} else {
					
				cropper.getCroppedCanvas().toBlob(function(blob) {
					var fileTempHold = {};
					fileTempHold['cropperOutputImage'] = blob;
					fileTempHold["croppedExtension"] = blob["type"].split("/")[1];
					fileTempHold['fileName'] = fileDetails["originalFileName"] + "." + fileTempHold["croppedExtension"];
					fileTempHold['uploadedImage'] = cropper.getCroppedCanvas().toDataURL();
					fileTempHold['existing'] = 'no';

					imageFiles.push(fileTempHold);
					appendImage();
				});
			
				$('#profile-picture-modal').modal('hide');
			}
		});

		$('#profile-picture-modal').on('shown.bs.modal', function() {
			cropper = new Cropper(cropperInputImage, {
				aspectRatio: 16 / 16,
				minCropBoxHeight: 280,
				minCropBoxWidth: 1364,
				viewMode:1,
				ready: function() { }
			});
		}).on('hidden.bs.modal', function() {
			cropBoxData = cropper.getCropBoxData();
			canvasData = cropper.getCanvasData();
			cropper.destroy();
		});

		function fasterPreview(uploader) {
			if (uploader.files && uploader.files[0]) {
				fileDetails["originalFileName"] = uploader.files[0]["name"].replace(/\.[^/.]+$/, "");
				fileDetails["originalExtension"] = uploader.files[0]["type"].split("/")[1];
				$('#uploaded-profile-picture').attr('src', window.URL.createObjectURL(uploader.files[0]));
				cropperInputImage = document.getElementById('uploaded-profile-picture');
				$('#profile-picture-modal').modal('show');
			}
		}

		$("#country").change(function() {
			var country_id = $('#country').val();

			$.ajax({
				url: '/api/states?country_id=' + country_id,
				type: 'GET',
				success: function(result) {
					$("#state").empty();
					$("#state").append("<option disabled selected>Select State...</option>")
					for (var i = 0; i < result.rows.length; i++) {
						var options;
						options = "<option value=" + result.rows[i].id + ">" + result.rows[i].name + "</option>";
						$("#state").append(options);
					}
				},
				error: function(error) {
					console.log("Error", error);
				}
			});
		});

		$("#marketplace_type_id").change(function() {
			var marketplace_type_id = $('#marketplace_type_id').val();

			if (marketplace_type_id == {{ marketplaceTypeCode.WTB }} || marketplace_type_id == {{ marketplaceTypeCode.WTT }} || marketplace_type_id == {{ marketplaceTypeCode.RFQ }})
			{
				$(".priceDiv").hide();
				$('#price').removeAttr('value');
			}
			else {
				$(".priceDiv").show();
				$("price").attr('value');
			}
			if (marketplace_type_id == {{ marketplaceTypeCode.WTB }} || marketplace_type_id == {{ marketplaceTypeCode.WTT }} || marketplace_type_id == {{ marketplaceTypeCode.RFQ }}) {
				$(".shippingDiv").hide();
				$('#shipping_cost').removeAttr('value');
			}
			else {
				$(".shippingDiv").show();
				$("shipping_cost").attr('value');
			}

			if (marketplace_type_id == {{ marketplaceTypeCode.WTT }}) {
				$(".exchangingProductDiv").show();
				$(".exchangingProductQuantityDiv").show();
				$("exchanging_product").attr('value');
				$("exchanging_product_quantity").attr('value');
			}
			else {
				$(".exchangingProductDiv").hide();
				$(".exchangingProductQuantityDiv").hide();
				$('#exchanging_product').removeAttr('value');
				$('#exchanging_product_quantity').removeAttr('value');
			}        
		});

		$("#category").change(function() {
			var category_id = $('#category').val();
			$('#attributePopup').empty();

			$.ajax({
				url: '/api/sub-categories?category_id=' + category_id,
				type: 'GET',
				success: function(result) {
					$("#sub_category").empty();
					$("#sub_category").append("<option disabled selected>Select Sub Category...</option>")
					for (var i = 0; i < result.rows.length; i++) {
						var options;
						options = "<option value=" + result.rows[i].id + ">" + result.rows[i].name + "</option>";
						$("#sub_category").append(options)
					}
				},
				error: function(error) {
					console.log("Error", error);
				}
			});

			$.ajax({
				url: '/api/category-attributes?populate=Attribute&category_id=' + category_id,
				type: 'GET',
				success: function(result) {
					$("#attributeDiv").empty();
					var attributeRow;
					attributeRow = '<tr></tr>';
					for (var i = 0; i < result.rows.length; i++) {
						var productAttribute;
						console.log(typeof(result.rows[i].Attribute.unit));
						productAttribute = "<tr><td>" + result.rows[i].Attribute.attr_name + "</td><td>" +
							"<input type='text' name=" + result.rows[i].Attribute.id + " class='shop_qty_num all-quantity-cart-items' style='width:auto;'></td></tr>"
	
						attributeRow = attributeRow + productAttribute;
					}
					var attributeSection = '<div class="form-group"><label class="label-control">Product Attributes </label>' +
						'<div class="col-lg-8 border" style="padding: 0px;"><div class="modal-body">' +
						'<div class="container"><table class="table"><thead><tr>' +
						'<th class="shop_list_title"><b>Attribute</b></th><th class="shop_list_title">' +
						'<b>Value</b></th><th></th></tr></thead><tbody>' + attributeRow + '</tbody></table></div></div></div></div>'

					$('#attributeDiv').append(attributeSection);
				},
				error: function(error) {
					console.log("Error", error);
				}
			});
		});

		$("#productForm").validate({
			rules: {
				product_name: "required",
				product_category_id: "required",
				sub_category_id: "required",
				marketplace_type_id: {
					required: function() {
						if ($("input[name=marketplace]").val() == 'Private Wholesale Marketplace') {
							return true;
						} else { return false; }
					}
				},
				product_location: "required",
				sku: {
					required: true,
				},
				price: {
					number: true,
					dollarsscents: true
				},
				quantity_available: {
					required: true,
					digits: true
				},
				city: {
					required: true,
					lettersonly: true
				},
				shipping_cost: {
					number: true,
					dollarsscents: true
				},
				status: "required",
				moq: {
					required: function() {
						if ($("input[name=marketplace]").val() == 'Private Wholesale Marketplace') {
							return true;
						} else { return false; }
					}
				},
				exchanging_product: {
					required: function() {
						if ($("select[name=marketplace_type_id]").val() == 3) {
							return true;
						} else { return false; }
					}
				},
				exchanging_product_quantity: {
					required: function() {
						if ($("select[name=marketplace_type_id]").val() == 3) {
							return true;
						} else { return false; }
					}
				}
			},
			messages: {
				product_name: "Please enter the product name",
				product_category_id: "Please select product category",
				sub_category_id: "Please select product sub-category",
				marketplace_type_id: "Please select Type",
				product_location: "Please select product origin",
				sku: {
					required: "Please enter Stock Keeping Unit"
				},
				price: {
					number: "Please enter valid product price",
					dollarsscents: "Only two decimal values accepted"
				},
				quantity_available: {
					required: "Please enter available quantity",
					digits: "Please enter valid available quantity"
				},
				city: {
					required: "Please enter product origin city",
					lettersonly: "Please enter vaild city name"
				},
				shipping_cost: {
					number: "Please enter valid shipping cost",
					dollarsscents: "Only two decimal values accepted"
				},
				status: "Please select product status",
				exchanging_product: "Please enter the exchanging product name",
				exchanging_product_quantity: "Please enter exchanging product quantity",
				moq: "Please enter minimum order quantity"
			}
		});

		$.validator.addMethod("lettersonly", function(value, element) {
			return this.optional(element) || /^[a-zA-Z ]*$/.test(value);
		}, "Letters only please");

		$.validator.addMethod("dollarsscents", function(value, element) {
			return this.optional(element) || /^\d{0,30}(\.\d{0,2})?$/i.test(value);
		}, "You must include two decimal places");


		$("#productForm").submit(function(e) {
			e.preventDefault();

			if($('#productForm').valid()){

				$("#product_status").prop("disabled", false);
			
				var temp1 = $.map($('.quantity'), function(el) {
					return el.value;
				});

				var quantArr = temp1.filter(function(v) { return v !== '' });

				var typeArr = $.map($('.discount_type:radio:checked'), function(el) {
					return el.value;
				});

				var temp2 = $.map($('.discount_amount'), function(el) {
					return el.value;
				});
		
				var amtArr = temp2.filter(function(v) { return v !== '' });

				var j = 0; 
				quantArr.forEach(function(element) {

					let discount = {};
					discount.status = 1;
					discount.quantity = quantArr[j];
					if (typeArr[j] == 'percentage_discount') {
						discount.type = 1;
						discount.percent_discount = amtArr[j];
					}
					else {
						discount.type = 2;
						discount.value_discount = amtArr[j];
					}
					discountArr.push(discount);
					j++;
				});

				let productInput = $("#productForm :input").filter(function(index, element) {
					return $(element).val() != '';
				}).serialize();

				attributeArr = $('#attributeDiv :input').filter(function(index, element) {
					return $(element).val() != '';
				}).serializeArray();
					
				$.ajaxSetup({ async: false });

				var form1 = new FormData();

				$.each(productBaseImage, function(i, file) {

					if(productBaseImage[i].existing == 'no'){
						form1.append("file[" + i + "]", productBaseImage[i].cropperOutputImage, productBaseImage[i].fileName);
					}
					else if(productBaseImage[i].existing == 'yes'){

						var imageObj = {};

						imageObj.status = 1;
						imageObj.type = 1;
						imageObj.base_image = 1;
						imageObj.url = productBaseImage[i].uploadedBaseImage;
								
						imageArr.push(imageObj);
					}
				});

				if( form1 && form1 !== 'null' && form1 !== 'undefined' ){

					$.ajax({
						type: 'POST',
						url: '/api/prod/multiple',
						data: form1,
						cache: false,
						dataType: 'json',
						processData: false,
						contentType: false,
						success: function(data) {

							var imageURLs = data.imageURLs, i = 0;
							imageURLs.forEach(function(element) {
								var imageobj = {};
								imageobj.status = 1;
								imageobj.type = 1;
								imageobj.base_image = 1;
								imageobj.url = imageURLs[i];
								imageArr.push(imageobj);
								i++;
							});	
						},
						error: function(error) {
							console.log("Error", error);
						}
					})
				}

				var form2 = new FormData();
				$.each(imageFiles, function(i, file) {
					if(imageFiles[i].existing == 'no'){
						form2.append("file[" + i + "]", imageFiles[i].cropperOutputImage, imageFiles[i].fileName);
					}
					else if(imageFiles[i].existing == 'yes'){
						var imageObj = {};
						imageObj.status = 1;
						imageObj.type = 1;
						imageObj.base_image = 0;
						imageObj.url = imageFiles[i].uploadedImage;
						imageArr.push(imageObj);
					}
				});

				if( form2 && form2 !== 'null' && form2 !== 'undefined' ){
							
					$.ajax({
						type: 'POST',
						url: '/api/prod/multiple',
						data: form2,
						cache: false,
						dataType: 'json',
						processData: false,
						contentType: false,
						success: function(data) {
							var imageURLs = data.imageURLs, i = 0;
							imageURLs.forEach(function(element) {	
								var imageobj = {};
								imageobj.status = 1;
								imageobj.type = 1;
								imageobj.base_image = 0;
								imageobj.url = imageURLs[i];

								imageArr.push(imageobj);
									i++;
								});									
						},
						error: function(error) {
							console.log('error', error);
						}
					});
				}

				if(!product_id)
					addProduct(productInput);
				else
					updateProduct(product_id,productInput)

				$.ajaxSetup({ async: true });	
			}		
		});

		$("#reset").click(function() {
			location.reload(true);
		});

		$("#editdiscount").click(function(e) {

			if (count < 3) {

				var domElement = '&nbsp;<div class="row discountRow"><div class="col-lg-1"><label  class="label-control">For</label></div><div class="col-lg-2">' +
					'<input type="text" class="form-control-customized form-control-sm quantity" name="discount_quantity' + count + '" id="discount_quantity' + count + '" placeholder="20"></div>' +
					'<div class="col-lg-2"><label  class="label-control">product user receives</label></div>' +
					'<div class="col-lg-3"><div class="row edit-listing-dis"><input type="radio" class="discount_type" id="percentage_discount0"' +
					'name="discount_type' + count + '" value="percentage_discount" checked onclick=testPercent(' + count + ');> Total Percent Discount&nbsp; &nbsp;' +
					'<input class="list_place_21 discount_amount percent_discount_amount' + count + '" type="text" name="percent_discount_amount' + count + '" placeholder="20%"></div>' +
					'<div class="row edit-listing-dis"><input type="radio" class="discount_type" id="value_discount' + count + '" name="discount_type' + count + '"' +
					'value="value_discount" onclick=testValue(' + count + ')> Total Value Discount &nbsp;&nbsp;<input class="list_place_21 discount_amount value_discount_amount' + count + '"' +
					'type="text" name="value_discount_amount' + count + '" placeholder="20$" style="display:none" /></div></div>'+
					'<div class="col-lg-1" style="float:right"><a href="javascript:;"  onclick="removeDiscount(this)"><small>Remove</small></a>'+
					'</div></div>'

				$('#discountAppend').append(domElement);

				count = count + 1;
				if (count == 3) {
					$(".discount_tier").hide();
				}
			}
		});

		if(imageFiles && (imageFiles.length > 0))
			appendImage();

		if(productBaseImage && (productBaseImage.length > 0))
			appendBaseImage();		
 	});
</script>
<div class="modal fade" id="profile-picture-modal" tabindex="-1" role="dialog" aria-labelledby="profile-picture-modalLabel"
 aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="profile-picture-modalLabel">Product Image Crop</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body" style="margin-right:35px">
				<div class="container">
					<img src="" style="max-width: 100% !important;" id="uploaded-profile-picture" alt="Profile Picture">
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="crop-product-image">Crop Image</button>
			</div>
		</div>
	</div>
</div>
{{> header/top-header LoggedInUser = LoggedInUser}}{{> vendor/vendor-menu}}

<div class="wrapper-content bg-gray">
	<div class="gtc-container">
		<div class="row">
			<div class="col-sm-2">
				{{> vendor/vendor-side-navbar}}
			</div>
			<div class="col-sm-10">
				<div class="ibox">
					<div class="ibox-content">
						<div class="ibox-title">
							<h2>
								{{#if editProduct.id}} Edit Product
								<input type="text" id="edit_product_id" value="{{editProduct.id}}" style="display:none">
								{{else}} Add Product
								{{/if}}
							</h2>
							<div class="alert" id="gtc-cart-alert">
								<button type="button" class="close" data-dismiss="alert">
									<span aria-hidden="true">&times;</span>
								</button>
								<span class="cart-message"></span>
							</div>
						</div>
						<div class="content-body">
							<form id="productForm" class="form">
								<div class="row">
									<div class="col-lg-12">
										<div class="form-group">
											<label class="label-control">Product Name
												<span class="text-danger">*</span>
											</label>
											<input type="text" class="form-control-customized form-control-sm" name="product_name" value="{{editProduct.product_name}}"
											 required>
										</div>
									</div>
									<div class="row col-lg-12">
										<div class="col-lg-6">
											<div class="form-group">
												<label class="label-control">Marketplace
													<span class="text-danger">*</span>
												</label>
												{{#ifCond this.type '==' 'wholesale'}}
													<input type="text" class="form-control-customized form-control-sm" name="marketplace" value="Private Wholesale Marketplace"
													 readonly> {{else ifCond this.type '==' 'shop'}}
													<input type="text" class="form-control-customized form-control-sm" name="marketplace" value="Public Marketplace" readonly> {{else ifCond this.type '==' 'services'}}
													<input type="text" class="form-control-customized form-control-sm" name="marketplace" value="Services Marketplace" readonly> {{else ifCond this.type '==' 'lifestyle'}}
													<input type="text" class="form-control-customized form-control-sm" name="marketplace" value="Lifestyle Marketplace" readonly> {{/ifCond}}
											</div>
										</div>
										{{#ifCond this.type '==' 'wholesale'}}
											<div class="col-lg-4">
												<div class="form-group">
													<label class="label-control">Type
														<span class="text-danger">*</span>
													</label>
													<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="marketplace_type_id"
													 id="marketplace_type_id">
														{{#if editProduct.marketplace_type_id}}
															<option value="{{editProduct.marketplace_type_id}}">{{editProduct.MarketplaceType.name}}</option>
														{{else}}
															<option disabled selected>Select Category...</option>
														{{/if}}
														{{#each marketplaceType}}
															{{#ifCond this.id '!=' ../editProduct.marketplace_type_id }}
																<option value="{{this.id}}">{{ Titlecase this.name}}</option>
															{{/ifCond}}
														{{/each}}
													</select>
												</div>
											</div>
										{{/ifCond}}
									</div>
									<div class="col-lg-6 exchangingProductDiv" style="display:none">
										<div class="form-group">
											<label class="label-control">Exchanging Product
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<input type="text" class="form-control-customized form-control-sm" name="exchanging_product" id="exchanging_product">
											</div>
										</div>
									</div>
									<div class="col-lg-6 exchangingProductQuantityDiv" style="display:none">
										<div class="form-group">
											<label class="label-control">Exchanging Product Qunatity
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<input type="text" class="form-control-customized form-control-sm" name="exchanging_product_quantity" id="exchanging_product_quantity">
											</div>
										</div>
									</div>
									<div class="col-lg-6">
										<div class="form-group">
											<label class="label-control">Category
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="product_category_id"
												 id="category" required>
													{{#if editProduct.product_category_id}}
														<option value="{{editProduct.product_category_id}}">{{Titlecase editProduct.Category.name}}</option>
													{{else}}
														<option disabled selected>Select Category...</option>
													{{/if}}
													{{#each categories}}
														{{#ifCond this.id '!=' ../editProduct.product_category_id}}
															<option value="{{this.id}}">{{ Titlecase this.name}}</option>
														{{/ifCond}}
													{{/each}}
												</select>
											</div>
										</div>
									</div>
									<div class="col-lg-6">
										<div class="form-group">
											<label class="label-control">Sub Category
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="sub_category_id" id="sub_category"
												 required>
													{{#if editProduct.sub_category_id}}
														<option value="{{editProduct.sub_category_id}}">{{editProduct.SubCategory.name}}</option>
													{{else}}
														<option disabled selected>Select Sub Category...</option>
													{{/if}}
												</select>
											</div>
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">Country
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="product_location" id="country"
												 required>
													{{#if editProduct.product_location}}
														<option value="{{editProduct.product_location}}">{{editProduct.Country.name}}</option>
													{{else}}
														<option disabled selected>Select Country...</option>
													{{/if}}
													{{#each country}}
														{{#ifCond this.id '!=' ../editProduct.product_location}}
															<option value="{{this.id}}">{{ this.name}}</option>
														{{/ifCond}}
													{{/each}}
												</select>
											</div>
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">State</label>
											<div class="input-group">
												<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="state_id" id="state"
												 value="">
													{{#if editProduct.state_id}}
														<option value="{{editProduct.state_id}}">{{editProduct.State.name}}</option>
													{{else}}
														<option disabled selected>Select State...</option>
													{{/if}}
												</select>
											</div>
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">City
												<span class="text-danger">*</span>
											</label>
											<input type="text" class="form-control-customized form-control-sm" name="city" value="{{editProduct.city}}">
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">SKU
												<span class="text-danger">*</span>
											</label>
											<input type="text" class="form-control-customized form-control-sm" placeholder="Stock keep unit" name="sku" value="{{editProduct.sku}}"
											 required>
										</div>
									</div>
									<div class="col-lg-4 priceDiv">
										<div class="form-group">
											<label class="label-control">Price
											</label>
											<input type="text" name="price" id="price" class="form-control-customized form-control-sm" value="{{editProduct.price}}">
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">Quantity Available
												<span class="text-danger">*</span>
											</label>
											<input type="text" id="quantity_available" name="quantity_available" class="form-control-customized form-control-sm" value="{{editProduct.quantity_available}}"
											 required>
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="label-control">Product Status
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<select class="custom-select form-control-customized form-control-sm custom_left_arrow_style" name="status"
												 id="product_status">
												{{#if editProduct.status}}
												<option value="{{editProduct.status}}" disabled selected>{{objectKey statusCode editProduct.status}}</option>
												{{else}}
												<option disabled selected>Select Status</option>
												{{/if}}
												<option value="ACTIVE">Active</option>
												<option value="INACTIVE">InActive</option>
												<option value="SUSPENDED">Suspended</option>
												<option value="SOLDOUT">Sold Out</option>
												</select>
											</div>
										</div>
									</div>
									{{#ifCond this.type '==' 'wholesale'}}
										<div class="col-lg-4">
											<div class="form-group">
												<label class="label-control">MOQ
													<span class="text-danger">*</span>
												</label>
												<input type="text" class="form-control-customized form-control-sm" name="moq" id="moq" value="{{editProduct.moq}}" placeholder="Minimum order Quantity">
											</div>
										</div>
									{{/ifCond}}
									<div class="col-lg-4 shippingDiv">
										<div class="form-group">
											<label class="label-control">Shipping Cost</label>
											<input type="text" class="form-control-customized form-control-sm" name="shipping_cost" id="shipping_cost" value="{{editProduct.shipping_cost}}">
										</div>
									</div>
									<div class="col-lg-12">
										<div class="form-group">
											<label class="label-control">Description</label>
											<textarea class="form-control-customized" name="description" rows="6">{{editProduct.description}}</textarea>
										</div>
									</div>
									{{#ifCond this.type '==' 'wholesale'}}
										<div class="col-lg-8">
											<div class="form-group">
												<label class="label-control">Add bulk order discount tier.</label>
												<div class="input-group">
													<div class="custom-file">
														 {{#ifCond editProduct.Discounts.length '<' 3}}
														<i class='fas fa-plus discount_tier' id="editdiscount"></i>
														{{else ifCond editProduct.Discounts.length '==' null}}	
														<i class='fas fa-plus discount_tier' id="editdiscount"></i>
														{{else}}
														<i class='fas fa-plus discount_tier' id="editdiscount" style="display:none"></i>
														{{/ifCond}}
													</div>
												</div>
												<section id="discountAppend">
													{{#if editProduct.Discounts}}
														{{#each editProduct.Discounts}}
														{{#ifCond @index '>' 0}}&nbsp; {{/ifCond}}
															<div class="row discountRow">
																<div class="col-lg-1">
																	<label  class="label-control">For</label>
																</div>
																<div class="col-lg-2">
																	<input type="text" class="form-control-customized form-control-sm quantity" value="{{this.quantity}}" name="discount_quantity{{@index}}" id="discount_quantity{{@index}}" placeholder="20">
																</div>
																<div class="col-lg-2">
																	<label  class="label-control">product user receives</label>
																</div>
																<div class="col-lg-3">
																	<div class="row edit-listing-dis">
																		<input type="radio" class="discount_type" id="percentage_discount{{@index}}" name="discount_type{{@index}}" value="percentage_discount" {{#ifCond this.type '==' 1}} checked {{/ifCond}} onclick=testPercent('{{@index}}');> Total Percent Discount&nbsp; &nbsp;
																		<input class="list_place_21 discount_amount percent_discount_amount{{@index}}" type="text" name="percent_discount_amount{{@index}}" placeholder="20%" value="{{this.percent_discount}}" {{#ifCond this.type '==' 2}} style="display:none" {{/ifCond}} >
																	</div>
																	<div class="row edit-listing-dis">
																		<input type="radio" class="discount_type" id="value_discount{{@index}}" name="discount_type{{@index}}" value="value_discount" {{#ifCond this.type '==' 2}} checked {{/ifCond}} onclick=testValue('{{@index}}');> Total Value Discount &nbsp;&nbsp;
																		<input class="list_place_21 discount_amount value_discount_amount{{@index}}" type="text" name="value_discount_amount{{@index}}" value="{{this.value_discount}}" placeholder="20$" {{#ifCond this.type '==' 1}} style="display:none" {{/ifCond}}/>
																	</div>
																</div>
																<div class="col-lg-1" style="float:right">
																	<a href="javascript:;"  onclick="removeDiscount(this)"><small>Remove</small></a>
																</div>
															</div>
														{{/each}}
													{{/if}}
												</section>
											</div>
										</div>
									{{/ifCond}}

									<div class="col-lg-8" id="attributeDiv">
										{{#if editProduct.ProductAttributes}}
											<div class="form-group">
												<label class="label-control">Product Attributes </label>
												<div class="col-lg-8 border" style="padding: 0px;">
													<div class="modal-body">
														<div class="container">
															<table class="table">
																<thead>
																	<tr>
																		<th class="shop_list_title">
																			<b>Attribute</b>
																		</th>
																		<th class="shop_list_title">
																			<b>Value</b>
																		</th>
																		<th></th>
																	</tr>
																</thead>
																<tbody>
																	{{#each editProduct.ProductAttributes}}
																	<tr>
																		<td>{{this.Attribute.attr_name}}</td>
																		<td>
																			<input type='text' name="{{this.attribute_id}}" value="{{this.value}}" class='shop_qty_num all-quantity-cart-items' style='width:auto;'>
																		</td>
																		<td>{{this.Attribute.unit}}</td>
																	</tr>
																	{{/each}}
																</tbody>
															</table>
														</div>
													</div>
												</div>
											</div>
										{{/if}}
									</div>

									<div class="col-lg-8">
										<div class="form-group">
											<label class="label-control">Upload product base image
												<span class="text-danger">*</span>
											</label>
											<div class="input-group">
												<input type="file" class="custom-file-input" id="baseImage" name="baseImage">
												<label class="custom-file-label customized-file-label" for="baseImage">Choose file</label>
											</div>
										</div>
										<div class="base_image">
										</div>
									</div>
								</div>
								<br/>
								<div class="row">
									<div class="col-lg-12">
										<div class="form-group">
											<label class="label-control">Add More Images( 6 max.)</label>
											<div class="input-group">
												<div class="custom-file">
													<i class='fas fa-plus' id='productImage'></i>
													<input type="file" class="custom-file-input" id="imageUpload" name="files" style="display:none">
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-12">
									<span class="preview"></span>
									</div>
								</div>
								<br/>
								<br/><hr/>

								<div class="row">
									<div class="col-md-12">
										<button class="ladda-button btn {{#if editProduct}}update-btn{{else}}btn-primary{{/if}} btn-small btn-muted" type="submit" data-style="expand-left">
											<span class="ladda-label">{{#if editProduct}}UPDATE{{else}}SUBMIT{{/if}}</span>
											<span class="ladda-spinner"></span>
										</button>
										<button class="ladda-button btn btn-small btn-muted" type="reset" id="reset" data-style="expand-left">
											<span class="ladda-label">CANCEL</span>
											<span class="ladda-spinner"></span>
										</button>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{{> footer/bottom-footer}}