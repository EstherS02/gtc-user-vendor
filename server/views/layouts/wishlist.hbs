<script type="text/javascript">
	function selectAll(ele) {
		var checkboxes = document.getElementsByTagName('input');
		if (ele.checked) {
			for (var i = 0; i < checkboxes.length; i++) {
				if (checkboxes[i].type == 'checkbox') {
					checkboxes[i].checked = true;
				}
			}
		} else {
			for (var i = 0; i < checkboxes.length; i++) {
				console.log(i)
				if (checkboxes[i].type == 'checkbox') {
					checkboxes[i].checked = false;
				}
			}
		}
	}
</script>
<script type="text/javascript">
	$("#CartUpdate").click(function(e) {
		e.preventDefault();
		var newCoupon = {};
		newCoupon.coupon_name = $('input[name=product_id]').val();
		newCoupon.discount_value = $('input[name=quantity]').val();

		$.ajax({
			type: 'POST',
			url: '/api/cart/',
			data: newCoupon,
			success: function(data, text) {
				window.location.href = '/wishlist';
			},
			error: function(request, status, error) {
				console.log('status', status);
				console.log('error', error);
			}
		});
	});

	function remove(e) {
		var chkArray = [];
		$(':checkbox:checked').each(function(i) {
			if($(this).val() != 'on'){
				// alert($(this).val());
			chkArray.push($(this).val());
			}
		});
		var selected;
		selected = chkArray.join(',');
		if (selected.length > 0) {
			window.location.href = '/wishlist/remove-wishes?id=' + selected;
		} else {
			alert("Please at least check one of the checkbox");
		}
	}
	function quantityCheck(val) {	
		
		if(val.max == 0){
			alert("Product Not Available " );		
		}
		if(val.value >  val.max)
		{
			alert("Available Quantity of the product is :" + val.max);		
			val.value = 1;
		}


    
}
</script>
{{> vendor/header}}
<section class="showing_categ">
	<div class="" >
		<div class="container">
			<div class="row">
				{{> vendor/navbar}} 
				<div class="col-md-10" style="background-color: #fff;">
					<h5 style="padding-top: 20px;">My Wishlist</h5>
					<div class="row">
						<div class="col-md-6">
							<input type="submit" value="REMOVE" onclick="remove(this)"  class="vend_edit_lists_buttonstyle" />
						</div>
						<div class="col-md-6">
							<input type="submit" value="DELETE LIST" class="vend_edit_lists_buttonstyle float-right" />
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<p class="vend_edit_lists_pstyle">{{this.count}} items total</p>
						</div>
						<div class="col-md-6">
							<p class="vend_edit_lists_pstyle float-right">Entries per page: 
								<a href="/wishlist?limit=10"> 10</a>
								<a href="/wishlist?limit=25"> 25</a>
								<a href="/wishlist?limit=100"> 100</a>
								<a href="/wishlist?limit=500"> All </a>
							</p>
						</div>
					</div>
					<div class="row">
						<table class="table table-hover">
							<thead>
								<tr>
									<th><input type="checkbox" onclick="selectAll(this);"></th>
									<th>Product Name</th>
									<th>Store Name</th>
									<th>Available</th>
									<th>Type</th>
									<th>price</th>
									<th>Add to Cart</th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								{{#each wishlist}}
								<tr>
									<td><input type="checkbox" value="{{this.id}}"></td>
									<td class="text_blue_color"><img src="{{this.Product.ProductMedium.url}}" style="width: 15px;" /> {{this.Product.product_name}}</td>
									<td class="text_blue_color">{{this.User.first_name}} {{this.User.last_name}}</td>
									{{#if this.Product.quantity_available}}
									<td class="text_green_color" style="font-size: 20px;"><i class="fas fa-check-circle"></i></td>
									{{else}}
									<td class="text_orange_color" style="font-size: 20px;"><i class="fas fa-exclamation-circle"></i></td>
									{{/if}}
									{{!-- Type --}}
									{{#ifCond this.Product.marketplace_id "==" 1}}
									<td>Wholesale</td> 
									{{else ifCond this.Product.marketplace_id "==" 2}}
									<td>Retail</td>
									{{else ifCond this.Product.marketplace_id "==" 3}}
									<td>Service</td> 
									{{else ifCond this.Product.marketplace_id "==" 4}}
									<td>Life style</td> 
									{{/ifCond}}
									{{!--End Type --}}
									<td class="text_blue_color">{{this.Product.price}}</td>
									<form method="POST" id="WishList">
										<input type="hidden" id="product_id" name="product_id" value="{{this.product_id}}">
										<input type="hidden" name="quantity_available" value="{{this.Product.quantity_available}}" id="quantity_available">
										<td class="text_blue_color">
										<input type="number" name="quantity" id="Quantity" min="1" max="{{this.Product.quantity_available}}" onkeypress="return event.charCode >= 48 && event.charCode <= 57" value="" placeholder="1" onchange="quantityCheck(this)">
										 Update 
										</td>
										<td class="text_blue_color "  id="CartUpdate"><i class="fas fa-credit-card"></i> Add to cart</td>
									</form>
								</tr>
								{{/each}}
							</tbody>
						</table>
					</div>
					<div class="row">
						<div class="col-md-6">
							<p class="vend_edit_lists_pstyle">{{this.count}} items total</p>
						</div>
						<div class="col-md-6">
							<p class="vend_edit_lists_pstyle float-right">Entries per page: 
								<a href="/wishlist?limit=10"> 10</a>
								<a href="/wishlist?limit=25"> 25</a>
								<a href="/wishlist?limit=100"> 100</a>
								<a href="/wishlist?limit=500"> All </a>
							</p>
						</div>
					</div>
				</div>		
			</div>
		</div>
	</div>
</section>
